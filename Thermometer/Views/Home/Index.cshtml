@{
  ViewData["Title"] = "Home Page";
}

<br/>


<form id="send-form" action="#" hidden>
   
  <input type="text" id="message-textbox"  hidden/> 
  <button id="send-button" type="submit" >Refresh</button>
</form>



<h4 id="temperature"></h4>

<ul id="messages-list" class="list-group"></ul>

@section Scripts {
  <script src="/lib/signalr/signalr.js"></script>
  <script type="text/javascript">
    // Bind DOM elements
    var sendForm = document.getElementById("send-form");
    var sendButton = document.getElementById("send-button");
    var messagesList = document.getElementById("messages-list");
    var messageTextBox = document.getElementById("message-textbox");

    function appendMessage(content) {
      //var li = document.createElement("li");
      //li.innerText = content;
      //messagesList.appendChild(li);

      var temp = document.getElementById("temperature");
      temp.innerText = content;
    }

    function appendAlert(content) {
      var li = document.createElement("li");
      li.innerText = content;
      li.classList.add("list-group-item");
      li.classList.add("list-group-item-danger");
      messagesList.appendChild(li);
    }

    var connection = new signalR.HubConnection("/hubs/update");

    sendForm.addEventListener("submit", function() {
      var message = messageTextBox.value;
      messageTextBox.value = "";
      connection.send("Send", message);
    });

    connection.on("SendMessage", function (sender, message) {
      appendMessage(message);
    });

    //connection.on("SendAction", function (sender, action) {
    //  appendMessage(sender + ' ' + action);
    //});

    connection.on("Alert",
      function(sender, message) {
        appendAlert(message);
      });


    connection.start().then(function() {
      messageTextBox.disabled = false;
      sendButton.disabled = false;
    });

    var clickMe = document.getElementById("send-button");

    clickMe.addEventListener('click', function() {
    }, true);

    setInterval(function() {
      var event = new MouseEvent('click'),
        canceled = !clickMe.dispatchEvent(event);

      if (canceled) {
        console.log('Click event was canceled');
      }
    }, 1000);
  </script>
}